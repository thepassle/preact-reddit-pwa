{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { h, Component } from 'preact';\n\nclass AsyncRoute extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tcomponentData: null\n\t\t};\n\t}\n\tloadComponent(){\n\t\tif (this.props.component) {\n\t\t\treturn this.setState({\n\t\t\t\tcomponentData: this.props.component\n\t\t\t});\n\t\t}\n\t\tconst componentData = this.props.getComponent(this.props.url, ({component}) => {\n\t\t\t// Named param for making callback future proof\n\t\t\tif (component) {\n\t\t\t\tthis.setState({\n\t\t\t\t\tcomponentData: component\n\t\t\t\t});\n\t\t\t}\n\t\t}, Object.assign({}, this.props, this.props.matches));\n\n\t\t// In case returned value was a promise\n\t\tif (componentData && componentData.then) {\n\t\t\t// IIFE to check if a later ending promise was creating a race condition\n\t\t\t// Check test case for more info\n\t\t\t((url)=>{\n\t\t\t\tcomponentData.then(component => {\n\t\t\t\t\tif (url !== this.props.url) {\n\t\t\t\t\t\tthis.setState({componentData: null}, () => {\n\t\t\t\t\t\t\tthis.loadComponent();\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tcomponentData: component\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})(this.props.url);\n\t\t}\n\t}\n\tcomponentWillReceiveProps(nextProps){\n\t\tif (this.props.path && this.props.path !== nextProps.path) {\n\t\t\tthis.setState({\n\t\t\t\tcomponentData: null\n\t\t\t}, ()=>{\n\t\t\t\tthis.loadComponent();\n\t\t\t});\n\t\t}\n\t}\n\tcomponentWillMount(){\n\t\tthis.loadComponent();\n\t}\n\trender(){\n\t\tif (this.state.componentData) {\n\t\t\treturn h(this.state.componentData, this.props);\n\t\t} else if (this.props.loading) {\n\t\t\tconst loadingComponent = this.props.loading();\n\t\t\treturn loadingComponent;\n\t\t}\n\t\treturn null;\n\t}\n}\n\nexport default AsyncRoute;\n"],"names":["AsyncRoute","state","loadComponent","props","component","setState","componentData","getComponent","url","matches","then","componentWillReceiveProps","nextProps","path","componentWillMount","render","h","loading","loadingComponent","Component"],"mappings":";;;;;;;;;;;;;;AAAA,IAEMA;;;uBACS;;;+CACb,qBADa;;QAERC,KAAL,GAAa;kBACG;GADhB;;;;sBAIDC,yCAAe;;;MACV,KAAKC,KAAL,CAAWC,SAAf,EAA0B;UAClB,KAAKC,QAAL,CAAc;mBACL,KAAKF,KAAL,CAAWC;IADpB,CAAP;;MAIKE,gBAAgB,KAAKH,KAAL,CAAWI,YAAX,CAAwB,KAAKJ,KAAL,CAAWK,GAAnC,EAAwC,gBAAiB;OAAfJ,SAAe,QAAfA,SAAe;;;OAE1EA,SAAJ,EAAe;WACTC,QAAL,CAAc;oBACED;KADhB;;GAHoB,EAOnB,SAAc,EAAd,EAAkB,KAAKD,KAAvB,EAA8B,KAAKA,KAAL,CAAWM,OAAzC,CAPmB,CAAtB;;;MAUIH,iBAAiBA,cAAcI,IAAnC,EAAyC;;;IAGvC,UAACF,GAAD,EAAO;kBACOE,IAAd,CAAmB,qBAAa;SAC3BF,QAAQ,OAAKL,KAAL,CAAWK,GAAvB,EAA4B;aACtBH,QAAL,CAAc,EAACC,eAAe,IAAhB,EAAd,EAAqC,YAAM;cACrCJ,aAAL;OADD;;;YAKIG,QAAL,CAAc;qBACED;MADhB;KAPD;IADD,EAYG,KAAKD,KAAL,CAAWK,GAZd;;;;sBAeFG,+DAA0BC,WAAU;;;MAC/B,KAAKT,KAAL,CAAWU,IAAX,IAAmB,KAAKV,KAAL,CAAWU,IAAX,KAAoBD,UAAUC,IAArD,EAA2D;QACrDR,QAAL,CAAc;mBACE;IADhB,EAEG,YAAI;WACDH,aAAL;IAHD;;;;sBAOFY,mDAAoB;OACdZ,aAAL;;;sBAEDa,2BAAQ;MACH,KAAKd,KAAL,CAAWK,aAAf,EAA8B;UACtBU,SAAE,KAAKf,KAAL,CAAWK,aAAb,EAA4B,KAAKH,KAAjC,CAAP;GADD,MAEO,IAAI,KAAKA,KAAL,CAAWc,OAAf,EAAwB;OACxBC,mBAAmB,KAAKf,KAAL,CAAWc,OAAX,EAAzB;UACOC,gBAAP;;SAEM,IAAP;;;;EA5DuBC,kBAgEzB;;;;"}